# ============================================
# CONFIGURACIÓN PARA PRODUCCIÓN (RAILWAY)
# ============================================

spring.application.name=Metamapa

# ============================================
# SERVER CONFIGURATION
# ============================================
server.port=${PORT:8083}

# ============================================
# DATABASE CONFIGURATION - POSTGRESQL
# ============================================
# Railway inyecta automáticamente: DATABASE_URL, PGHOST, PGUSER, PGPASSWORD, PGDATABASE
spring.datasource.url=${DATABASE_URL}
spring.datasource.username=${PGUSER:${DATABASE_USERNAME}}
spring.datasource.password=${PGPASSWORD:${DATABASE_PASSWORD}}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA/Hibernate Configuration
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# ============================================
# SECURITY CONFIGURATION
# ============================================
application.security.jwt.secret-key=${JWT_SECRET_KEY}

# ============================================
# EXTERNAL API CONFIGURATION
# ============================================
proxy.api.token=${PROXY_API_TOKEN:rY3j0CD1b4hpJBNWwZvJkva2NhsGEukeS2pFQkjE2yMBmk6sdlGQ5ATQkpYo}
proxy.api.base-url=${PROXY_API_BASE_URL:https://api-ddsi.disilab.ar/public}

# ============================================
# FILE UPLOAD CONFIGURATION
# ============================================
spring.servlet.multipart.max-file-size=20MB
spring.servlet.multipart.max-request-size=20MB

# ============================================
# HIBERNATE BATCH CONFIGURATION
# ============================================
spring.jpa.properties.hibernate.jdbc.batch_size=1000
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# ============================================
# GRAPHQL CONFIGURATION
# ============================================
spring.graphql.graphiql.enabled=false
spring.graphql.path=/graphql

# ============================================
# ACTUATOR CONFIGURATION
# ============================================
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when-authorized
management.health.db.enabled=true

# ============================================
# RATE LIMITING CONFIGURATION
# ============================================
rate.limit.public.capacity=${RATE_LIMIT_PUBLIC_CAPACITY:100}
rate.limit.public.refill-period=${RATE_LIMIT_PUBLIC_REFILL:60}

rate.limit.authenticated.capacity=${RATE_LIMIT_AUTHENTICATED_CAPACITY:200}
rate.limit.authenticated.refill-period=${RATE_LIMIT_AUTHENTICATED_REFILL:60}

rate.limit.admin.capacity=${RATE_LIMIT_ADMIN_CAPACITY:500}
rate.limit.admin.refill-period=${RATE_LIMIT_ADMIN_REFILL:60}

rate.limit.auth.capacity=${RATE_LIMIT_AUTH_CAPACITY:5}
rate.limit.auth.refill-period=${RATE_LIMIT_AUTH_REFILL:300}

rate.limit.create-hecho.capacity=${RATE_LIMIT_CREATE_HECHO_CAPACITY:10}
rate.limit.create-hecho.refill-period=${RATE_LIMIT_CREATE_HECHO_REFILL:60}

# ============================================
# IP ACCESS CONTROL CONFIGURATION
# ============================================
ip.access.whitelist.enabled=${IP_WHITELIST_ENABLED:false}
ip.access.whitelist.ips=${IP_WHITELIST_IPS:}

ip.access.blacklist.enabled=${IP_BLACKLIST_ENABLED:true}
ip.access.blacklist.ips=${IP_BLACKLIST_IPS:}

ip.access.allow-localhost=${IP_ALLOW_LOCALHOST:true}

# ============================================
# LOGGING CONFIGURATION
# ============================================
logging.level.root=INFO
logging.level.ar.utn.ba.ddsi.Metamapa=INFO
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

